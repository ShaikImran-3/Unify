trigger:
- main  # branch to trigger pipeline
 
pool:
  name: 'Default'  # or your self-hosted agent with Tosca installed
 
steps:
- task: PowerShell@2
  displayName: 'Run Tosca Tests'
  inputs:
    targetType: 'inline'
    script: |
      # Path to Tosca CommandLine executable
      $ToscaCmdPath = "C:\Tosca\ToscaCommanderCMD.exe"
      
      # ExecutionList and Workspace
      $ExecutionList = "C:\ToscaWorkspace\ExecutionLists\MyExecutionList.xml"
      $Workspace = "C:\ToscaWorkspace\MyWorkspace.twsx"
      
      # Result folder
      $ResultFolder = "C:\ToscaResults"
      
      # Run Tosca
      & $ToscaCmdPath /ExecutionList=$ExecutionList /ProjectPath=$Workspace /ResultFolder=$ResultFolder /LoginUser="username" /Password="password"
      
      # Check results
      if($LASTEXITCODE -ne 0) {
          Write-Error "Tosca Tests failed. Check results in $ResultFolder"
          exit 1
      }
